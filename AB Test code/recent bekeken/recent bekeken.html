
<html>
<script>
//get all the data from the current PDP needed to make product tiles (udata should be populated before AB test tool Adobe Target is ready)

var pageTemplate = udata.currentPage.page_template;
var link = window.location.href;
var productID = udata.currentPage.products[0].id;
var productName = document.getElementsByClassName("main_header")[0].innerText;
var productPrice = udata.currentPage.products[0].price;
var productImgBig = document.querySelector("#productMainImage").src;
var productImg = productImgBig.replace("646x1000","200x310");

//place in object
const recentProduct = { productID: productID, productName: productName,productPrice: productPrice,productImg: productImg,productLink: link};

// there is recent product local storage object, check if it is exists and is empty, if not create the object and populate with current product. If it exists check if it already contains 8 products ( as this is the maximum amount of product we will show in recent products carousel, else check if current product isn't already in list ELSE just add the current product the the existing list smaller than 8 )

var recentProducts = JSON.parse(localStorage.getItem("recent-products")); //create var out of local storage object
console.log(recentProducts);
if (recentProducts) {
var lastItem = recentProducts[recentProducts.length - 1]; //made to check if current product page isn't already in the list , else we we show same product several times in recent product list
};

if (recentProducts == null || recentProducts == undefined) {
	  var recentProducts = [recentProduct];
      localStorage.setItem('recent-products', JSON.stringify(recentProducts));
    } else if (lastItem.productID == productID) {
    	console.log("already in recent product list");
	} else if (recentProducts.length >= 8){
		recentProducts.shift();
		recentProducts.push(recentProduct);
    localStorage.setItem('recent-products', JSON.stringify(recentProducts));
	} else {
		recentProducts.push(recentProduct);
    localStorage.setItem('recent-products', JSON.stringify(recentProducts));
 };
</script>
<script>
	var recentProducts = JSON.parse(localStorage.getItem("recent-products")); //create var out of local storage object
	console.log(recentProducts);

 	var content = document.querySelector("#contentWrapper");
 	var node = document.createElement("div"); 
 	node.classList.add("catnav-circles");
 	var nodeh2 = document.createElement("h2"); 
 	nodeh2.classList.add("recenth2");
 	nodeh2.innerHTML = "Eerder bekeken";
 	content.appendChild(nodeh2);

 	for (let i = 0; i < recentProducts.length; i++) {
    node.innerHTML += '<a href="' + recentProducts[i].productLink + '">' + '<img src="' + recentProducts[i].productImg + '">' + '<p>' + recentProducts[i].productName + '</p>' + '<div class="pricerecent"><span>â‚¬</span>' + recentProducts[i].productPrice + '</div>' + '</a>';
 	content.appendChild(node);
}
 	
 </script>
<style>
.catnav-circles {
        display: -webkit-box;
        display: -ms-flexbox;
        display: flex !important;
        -webkit-box-orient: horizontal;
        -webkit-box-direction: normal;
        -ms-flex-direction: row;
        flex-direction: row;
        overflow-x: auto;
        overflow-y: hidden;
        -ms-overflow-style: none;
        scrollbar-width: none;
        width: auto;
        min-width: 100%;
        min-height: 100%;
        justify-content: space-between;
    }
@media (max-width: 601px){
	.catnav-circles {
        display: -webkit-box;
        display: -ms-flexbox;
        display: flex !important;
        -webkit-box-orient: horizontal;
        -webkit-box-direction: normal;
        -ms-flex-direction: row;
        flex-direction: row;
        overflow-x: auto;
        overflow-y: hidden;
        -ms-overflow-style: none;
        scrollbar-width: none;
        width: auto;
        min-width: 100%;
        min-height: 100%;
        justify-content: space-between;
    }
}
    
   
    .catnav-circles::-webkit-scrollbar {
        display: none !important;
    }
    .catnav-circles a {
        display: -webkit-box;
        display: -ms-flexbox;
        display: flex;
        -webkit-box-orient: vertical;
        -webkit-box-direction: normal;
        -ms-flex-direction: column;
        flex-direction: column;
        padding: 8px;
        width:130px;
	    border-radius: 15px;
	    border-width: thin;
	    border-color: #cacaca;
	    border-style: solid;
	    justify-content: space-around;
    }
    .catnav-circles a img {
        width: auto;
	    height: -webkit-fill-available;
	    max-height: 100px;
	    max-width: 80px;
	    margin: 0 auto;
    }
    .catnav-circles a p {
        color: #005BA9;
        text-align: center;
        line-height: 1em;
        margin-top: 10px;
        -webkit-hyphens: auto;
        -ms-hyphens: auto;
        hyphens: auto;
        font-size: 14px;
    }
    .recenth2 {
		margin-top: 32px;
	    margin-bottom: 24px;
	    color: #005ba9;
	    font-size: 28px;
	    line-height: 22px;
	    font-family: "Roboto Condensed",sans-serif;
	    font-weight: 400;
	}	
</style>
</html>